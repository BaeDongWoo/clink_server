<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.josam.clink.communityManager.CommunityManagerMapper">
	<insert id="insertComment" parameterType="com.josam.clink.communityPost.CommunityPostVO" useGeneratedKeys="true" keyProperty="comment_id">
		INSERT INTO Comment_Detail 
				(board_no, register_id, register_datetime, comment_content, parent_id)
		values(#{board_no}, #{register_id}, now(), #{comment_content}, #{parent_id})
	</insert>
	<select id="getCommentId">
		SELECT MAX(comment_id)
		FROM Comment_Detail
	</select>
	<insert id="insertReply" parameterType="com.josam.clink.communityPost.CommunityPostVO" useGeneratedKeys="true" keyProperty="comment_id">
		INSERT INTO Comment_Detail 
				(board_no, register_id, register_datetime, comment_content, parent_id)
		values(#{board_no}, #{register_id}, now(), #{comment_content}, #{parent_id})
	</insert>
	<select id="getPost" parameterType="STRING" resultType="com.josam.clink.communityPost.CommunityPostVO">
		SELECT 
			board_no, 
			board_title, 
			board_content, 
			register_datetime, 
			register_id, 
			board_like_count,
			hashtag_content,
			board_views
		FROM Board_Detail 
		WHERE board_no=#{board_no} 
		ORDER BY register_datetime DESC;
	</select>
	<update id="updateBoard" parameterType="com.josam.clink.communityPost.CommunityPostVO" >
		UPDATE Board_Detail SET 
			board_title = #{board_title},
			board_content = #{board_content},
		    update_datetime = now(),
		    hashtag_content= #{hashtag_content}
		WHERE board_no = #{board_no};
	</update>
	<delete id="deleteBoard" parameterType="INTEGER">
		DELETE FROM Board_Detail 
		WHERE board_no = #{board_no};
	</delete>
	
	<select id="getComment" parameterType="STRING" resultType="com.josam.clink.communityManager.CommentVO">
		SELECT * 
		FROM Comment_Detail 
		WHERE board_no=#{board_no} 
		ORDER BY register_datetime ASC;
	</select>
	
	<delete id="deleteComment" parameterType="INTEGER">
		DELETE FROM Comment_Detail 
		WHERE comment_id = #{comment_id};
	</delete>
	<insert id="insertPost" parameterType="com.josam.clink.communityPost.CommunityPostVO">
		insert into Board_Detail(user_no,category_no,board_views,board_title,board_content,board_like_count,hashtag_content,register_datetime,register_id) values("0",#{category_no},0,#{board_title},#{board_content},0,#{hashtag_content},now(),"test1")
	</insert>
	<insert id="insertHashtag" parameterType="String">
		insert into Hashtag_Detail(category_no,hashtag_content,register_datetime,register_id) values(#{category_no},#{hashtag},now(),"test")
	</insert>

</mapper>